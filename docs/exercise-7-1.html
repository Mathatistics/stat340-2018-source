<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Methods in Statistics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="therimalaya/stat340" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Solve Sæbø">


<meta name="date" content="2017-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="generalized-linear-model.html">
<link rel="next" href="exercise-8.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a><ul>
<li class="chapter" data-level="" data-path="reference-books.html"><a href="reference-books.html"><i class="fa fa-check"></i>Reference Books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="create-new-project.html"><a href="create-new-project.html"><i class="fa fa-check"></i>Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-1-data-import.html"><a href="exercise-1-data-import.html"><i class="fa fa-check"></i>Exercise 1: Data Import</a></li>
<li class="chapter" data-level="" data-path="exercise-2-export-data-to-a-file.html"><a href="exercise-2-export-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 2 - Export data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-3-exploring-the-data.html"><a href="exercise-3-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 3 - Exploring the data</a></li>
<li class="chapter" data-level="" data-path="exercise-4-subsets-of-data-and-logical-operators.html"><a href="exercise-4-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 4 - Subsets of data and logical operators</a></li>
<li class="chapter" data-level="" data-path="exercise-5-graphics.html"><a href="exercise-5-graphics.html"><i class="fa fa-check"></i>Exercise 5 - Graphics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i>Analysis of variance</a><ul>
<li class="chapter" data-level="" data-path="exercise-four.html"><a href="exercise-four.html"><i class="fa fa-check"></i>Exercise Four</a></li>
<li class="chapter" data-level="" data-path="exercise-five.html"><a href="exercise-five.html"><i class="fa fa-check"></i>Exercise Five</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i>Multivariate Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="exercise-7.html"><a href="exercise-7.html"><i class="fa fa-check"></i>Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-1.html"><a href="exercise-7-1.html"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="exercise-8.html"><a href="exercise-8.html"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effect-model.html"><a href="mixed-effect-model.html"><i class="fa fa-check"></i>Mixed Effect Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-9.html"><a href="exercise-9.html"><i class="fa fa-check"></i>Exercise 9</a></li>
<li class="chapter" data-level="" data-path="exercise-10.html"><a href="exercise-10.html"><i class="fa fa-check"></i>Exercise 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="group-exercises.html"><a href="group-exercises.html"><i class="fa fa-check"></i>Group Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercise-one.html"><a href="exercise-one.html"><i class="fa fa-check"></i>Exercise One</a></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/solve.saebo" target="blank">Solve Sæbø</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Raju Rimal</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-7-1" class="section level2">
<h2>Exercise 7</h2>
<div id="ex-1-discrimination-and-classification" class="section level3">
<h3>Ex-1: Discrimination and classification</h3>
<ol style="list-style-type: lower-alpha">
<li>Consider the famous iris data set <code>iris.train.rdata</code> as introduced in lesson 8. Reproduce the pairs plot for the four sepal and petal variables as given in lesson 8 slide 4. Which variable appears to be discriminating the species best? And which is worst?</li>
</ol>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<p>The two classes are best separated from the point of view of Petal.Length. The Sepal.Width looks like the worst discriminator.</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Explain the difference between “discrimination” and “classification”.</li>
</ol>
<div class="ans">
<p>Discrimination corresponds to the model fitting process in statistical inference. We seek good variables for discriminating classes. Classification corresponds to the actual prediction of new samples, that is, to allocate new samples to classes using the presumably best “classifier”-model estimated from the training data.</p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Explain what is meant by the assumption “We assume apriori that versicolor and virginica are equally likely”.</li>
</ol>
<div class="ans">
<p>This means that both species are equally probable if you sample a random plant from the population.</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Fit an LDA model to the iris data using Sepal.Length as the predictor. Assume equal prior probabilities for both species. Use the <code>print()</code>-function on you fitted model. What are the sample means of each species for this predictor variable?</li>
</ol>
<div class="ans">
<pre><code>Call:
lda(Species ~ Sepal.Length, data = iris.train, prior = c(0.5, 
    0.5))

Prior probabilities of groups:
versicolor  virginica 
       0.5        0.5 

Group means:
           Sepal.Length
versicolor       5.8950
virginica        6.5925

Coefficients of linear discriminants:
                  LD1
Sepal.Length 1.885221</code></pre>
<p>The means are reported in the print output as <code>Group means</code>.</p>
</div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Source in the <code>CV.class.R</code> file (open the fil in the script window and press the “Source” button to the upper right). Look at the <code>CV.class.examples.R</code>-file for reference. Perform a Leave-One-Out Cross-Validation of the model you fitted in the previous exercise. Report the confusion matrix, the accuracy and the cross-validated error rate.</li>
</ol>
<div class="ans">
<pre><code>            True
Predicted    versicolor virginica
  versicolor         32        11
  virginica           8        29
  Total              40        40
  Correct            32        29

Proportions correct
versicolor  virginica 
     0.800      0.725 

N correct/N total = 61/80 = 0.7625</code></pre>
<p>The confusion matrix is given in the first part of the output. 32 out of 40 versicolor are correctly classified, whereas 29 out of 40 virginica are correct. In total 61 out of 80 are correctly classified giving an accuracy of 0.7625 as reported. The APER is 1-accuracy, hence APER=1-0.7625 = 0.2375. We typically seek classifiers that minimize the classification error rate.</p>
</div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Use the scheme from exercises d. and e. to identify a good classifier for iris species. You may use either <code>lda</code> or <code>qda</code> and you may use one or several predictors. Report the cross-validated error for you “best choice”.</li>
</ol>
<div class="ans">
<p>Through some trial and error, and by looking at the pairs-plot from exercise a, my personal choice is the following model:</p>
<pre><code>            True
Predicted    versicolor virginica
  versicolor         38         2
  virginica           2        38
  Total              40        40
  Correct            38        38

Proportions correct
versicolor  virginica 
      0.95       0.95 

N correct/N total = 76/80 = 0.95</code></pre>
<p>This has an accuracy of 0.95 and, hence, an error of 0.05.</p>
</div>
<ol start="7" style="list-style-type: lower-alpha">
<li>What is the model assumption difference between an LDA and a QDA model?</li>
</ol>
<div class="ans">
<p>In LDA we assume equal variance structure for all classes, whereas in QDA we assume different variance structures for all classes.</p>
</div>
<ol start="8" style="list-style-type: lower-alpha">
<li>Use the model of your choice to predict the samples in <code>iris.test.rdata</code>. Use the <code>confusion()</code>-function in the mixlm-library to evaluate the performance of your classifier.</li>
</ol>
<div class="ans">
<pre><code>            True
Predicted    versicolor virginica
  versicolor         10         0
  virginica           0        10
  Total              10        10
  Correct            10        10

Proportions correct
versicolor  virginica 
         1          1 

N correct/N total = 20/20 = 1</code></pre>
<p>The model I found in f. gave a perfect classification, accuracy=1.0 and error=0.0.</p>
</div>
</div>
<div id="ex-2-logistic-regression" class="section level3">
<h3>Ex-2: Logistic regression</h3>
<ol style="list-style-type: lower-alpha">
<li>We will consider the Species variable of the <code>iris.train.rdata</code> set as a binary response variable in these exercises. You may use the <code>Species</code> variable directly as response in the models. R will recode “versicolor” as 0 and “virginica” as 1. Hence, we will model the probability of a plant being “virginica” as a function of the predictor variable(s). Fit a logist regression model for Species using Petal.Length as predictor. Report the estimated coefficients of the linear predictor. Is the Petal.Length variable a significant predictor for the probability of “virginica” at 5% test level? What is the AIC-value?</li>
</ol>
<div class="ans">
<pre><code>
Call:
glm(formula = Species ~ Petal.Length, family = binomial, data = iris.train)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-2.29059  -0.04614  -0.00002   0.05374   1.48205  

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)   -52.543     16.349  -3.214  0.00131 **
Petal.Length   10.802      3.345   3.230  0.00124 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 110.904  on 79  degrees of freedom
Residual deviance:  23.162  on 78  degrees of freedom
AIC: 27.162

Number of Fisher Scoring iterations: 8</code></pre>
<p>The <code>Petal.length</code> is according to the Wald test significant at all test levels larger than 0.00124.</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>What is the estimated probability of a plant having <code>Petal.Length</code> equal to 5 to be a “virginica”?</li>
</ol>
<div class="ans">
<pre><code>        1 
0.8127315 </code></pre>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Compute the AIC also for models with each of the other three variables as sole predictors. Which model is preferable from the AIC point of view?</li>
</ol>
<div class="ans">
<pre><code>[1] 27.16152</code></pre>
<pre><code>[1] 33.37987</code></pre>
<pre><code>[1] 103.8161</code></pre>
<pre><code>[1] 84.58985</code></pre>
<p>The <code>Petal.Length</code> variable gives the smallest AIC when used as predictor. It is marginally better than <code>Petal.Width</code> as prdictor.</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>(Optional) Try to construct a plot like the plot on slide 9 from lesson 9 with <code>Petal.Length</code> as predictor. You may need to make a variable <code>y</code> by <code>y &lt;- ifelse(iris.train$Species==&quot;virginica&quot;,1,0)</code> first. You may also check out the code for slide 9 from the <code>Generalized1.rmd</code> file available on Fronter for more hints.</li>
</ol>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
</div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Use a logistic model of your choice (perhaps the same predictors as you used in your best choice classifier of Ex-1) to estimate the posterior probabilities of “virginica” for the samples of the <code>iris.test.Rdata</code> set. Allocate the samples to the most probable species class and use the <code>confusion()</code> function to evaluate the classification performance. (Hint: The posterior probabilies, say you name then <code>postprob</code>, should be classified into a factor variable by</li>
</ol>
<div class="ans">
<pre><code>            True
Predicted    versicolor virginica
  versicolor         10         1
  virginica           0         9
  Total              10        10
  Correct            10         9

Proportions correct
versicolor  virginica 
       1.0        0.9 

N correct/N total = 19/20 = 0.95</code></pre>
<p>With my chosen model I got one mis-classification and an error rate of 0.05.</p>
</div>

</div>
</div>
<script>
ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="generalized-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-8.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["STAT340-2017.pdf", "STAT340-2017.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
