<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Methods in Statistics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="therimalaya/stat340" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Solve Sæbø">


<meta name="date" content="2017-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exercise-7-1.html">
<link rel="next" href="mixed-effect-model.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a><ul>
<li class="chapter" data-level="" data-path="reference-books.html"><a href="reference-books.html"><i class="fa fa-check"></i>Reference Books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="create-new-project.html"><a href="create-new-project.html"><i class="fa fa-check"></i>Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-1-data-import.html"><a href="exercise-1-data-import.html"><i class="fa fa-check"></i>Exercise 1: Data Import</a></li>
<li class="chapter" data-level="" data-path="exercise-2-export-data-to-a-file.html"><a href="exercise-2-export-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 2 - Export data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-3-exploring-the-data.html"><a href="exercise-3-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 3 - Exploring the data</a></li>
<li class="chapter" data-level="" data-path="exercise-4-subsets-of-data-and-logical-operators.html"><a href="exercise-4-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 4 - Subsets of data and logical operators</a></li>
<li class="chapter" data-level="" data-path="exercise-5-graphics.html"><a href="exercise-5-graphics.html"><i class="fa fa-check"></i>Exercise 5 - Graphics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i>Analysis of variance</a><ul>
<li class="chapter" data-level="" data-path="exercise-four.html"><a href="exercise-four.html"><i class="fa fa-check"></i>Exercise Four</a></li>
<li class="chapter" data-level="" data-path="exercise-five.html"><a href="exercise-five.html"><i class="fa fa-check"></i>Exercise Five</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i>Multivariate Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="exercise-7.html"><a href="exercise-7.html"><i class="fa fa-check"></i>Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-1.html"><a href="exercise-7-1.html"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="exercise-8.html"><a href="exercise-8.html"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effect-model.html"><a href="mixed-effect-model.html"><i class="fa fa-check"></i>Mixed Effect Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-9.html"><a href="exercise-9.html"><i class="fa fa-check"></i>Exercise 9</a></li>
<li class="chapter" data-level="" data-path="exercise-10.html"><a href="exercise-10.html"><i class="fa fa-check"></i>Exercise 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="group-exercises.html"><a href="group-exercises.html"><i class="fa fa-check"></i>Group Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercise-one.html"><a href="exercise-one.html"><i class="fa fa-check"></i>Exercise One</a></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/solve.saebo" target="blank">Solve Sæbø</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Raju Rimal</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-8" class="section level2">
<h2>Exercise 8</h2>
<div id="ex-1-count-data" class="section level3">
<h3>Ex-1: Count data</h3>
<p>Consider the plant species count data used in <a href="http://arken.umb.no/~solvsa/STAT340/Generalized2.html#1">lesson 10</a>.</p>
<ol style="list-style-type: lower-alpha">
<li>Redo the analysis using the <code>Biomass</code> and <code>pH</code> variables as predictors for species counts (as in slide 9). Find separate expressions for the estimated linear predictors <span class="math inline">\(\hat{\eta}_j\)</span> for each <code>pH</code>-level <span class="math inline">\(j\)</span> = “<code>low</code>”,“<code>medium</code>”,“<code>high</code>”. Also find the estimated expected count for <code>Biomass = 2</code> and <code>pH = high</code>.</li>
</ol>
<div class="ans">
<p>First we fit the model:</p>
<pre><code>              Estimate Std. Error   z value
(Intercept)  3.3217576 0.03883244  85.54079
Biomass     -0.1275586 0.01014076 -12.57880
pH(high)     0.5271844 0.03400435  15.50344
pH(low)     -0.6092096 0.04124607 -14.77012
                                                               Pr(&gt;|z|)
(Intercept) 0.000000000000000000000000000000000000000000000000000000000
Biomass     0.000000000000000000000000000000000002761826998525636628778
pH(high)    0.000000000000000000000000000000000000000000000000000003288
pH(low)     0.000000000000000000000000000000000000000000000000228291575</code></pre>
<p>Then the estimated linear predictors are:</p>
<p><span class="math display">\[\eta_\text{low} = 3.85 - 0.128\cdot \text{Biomass} - 1.14\]</span></p>
<p><span class="math display">\[\eta_\text{medium} = 3.85 - 0.128\cdot \text{Biomass} - 0.45\]</span></p>
<p><span class="math display">\[\eta_\text{high} = 3.85 - 0.128\cdot \text{Biomass}\]</span></p>
<p>For <code>Biomass = 2</code> and <code>pH = high</code> the estimated expected count is:</p>
<p><span class="math display">\[\hat{\lambda} = \exp(3.85 - 0.128\cdot 2) = 36.4\]</span></p>
<p>Alternatively we could compute this in R by:</p>
<pre><code>       1 
36.37293 </code></pre>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit the same model as in a. using the quasipoisson approach. Is there any evidence of overdisperion?</li>
</ol>
<div class="ans">
<pre><code>
Call:
glm(formula = Species ~ Biomass + pH, family = quasipoisson, 
    data = species)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.5959  -0.6989  -0.0737   0.6647   3.5604  

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)  3.32176    0.04085   81.31 &lt;0.0000000000000002 ***
Biomass     -0.12756    0.01067  -11.96 &lt;0.0000000000000002 ***
pH(high)     0.52718    0.03577   14.74 &lt;0.0000000000000002 ***
pH(low)     -0.60921    0.04339  -14.04 &lt;0.0000000000000002 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for quasipoisson family taken to be 1.106751)

    Null deviance: 452.346  on 89  degrees of freedom
Residual deviance:  99.242  on 86  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 4</code></pre>
<p>The dispersion parameter is only marginally larger than 1. We conclude that over-disperion is not a problem here.</p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Extend the model from a. by including an interaction between Biomass and pH. Test the significance of the interaction. Is there a significant difference between pH=“high” and pH=“medium” with regard to the effect of Biomass to the species count?</li>
</ol>
<div class="ans">
<pre><code>
Call:
glm(formula = Species ~ Biomass * pH, family = poisson, data = species)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4978  -0.7485  -0.0402   0.5575   3.2297  

Coefficients:
                 Estimate Std. Error z value             Pr(&gt;|z|)    
(Intercept)       3.38578    0.04121  82.159 &lt; 0.0000000000000002 ***
Biomass          -0.16944    0.01483 -11.426 &lt; 0.0000000000000002 ***
pH(high)          0.38234    0.05441   7.027     0.00000000000211 ***
pH(low)          -0.43323    0.06294  -6.883     0.00000000000585 ***
Biomass:pH(high)  0.06231    0.01649   3.779             0.000158 ***
Biomass:pH(low)  -0.09272    0.02650  -3.499             0.000466 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 452.346  on 89  degrees of freedom
Residual deviance:  83.201  on 84  degrees of freedom
AIC: 514.39

Number of Fisher Scoring iterations: 4</code></pre>
<pre><code>Analysis of Deviance Table

Model 1: Species ~ Biomass + pH
Model 2: Species ~ Biomass * pH
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1        86     99.242                          
2        84     83.201  2    16.04 0.0003288 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The interaction term is highly significant with a p-value of 0.00033. The Wald tests (the approximate normal test) given in the summary output gave a p-value of 0.167 for the term <code>Biomass:pHmid</code> which really is the contrast between interactions <code>Biomass:pHhigh</code>and <code>Biomass:pHmedium</code> since <code>pHhigh</code> is the reference level in this model. The relatively large p-value says that there is no evidence that Biomass has different effect on counts for these two pH-levels.</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Optional R-programming exercise for those interested: Reproduce the graph on slide 3 of lesson 10 and add curves visualizing the estimated expected counts as a function of Biomass and with separate curves for the pH-levels. The curves should be based on the fitted model with interaction between Biomass and pH-level.</li>
</ol>
<div class="ans">
<h4 id="answers-from-students">Answers from students</h4>
<h5 id="denis-tafintsev">Denis Tafintsev</h5>
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<h4 id="camilo-esteban-silva-chiang">Camilo Esteban Silva Chiang</h4>
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-165-1.png" width="672" /><img src="STAT340-2017_files/figure-html/unnamed-chunk-165-2.png" width="672" /></p>
</div>
</div>
<div id="ex-2-multinomial-data" class="section level3">
<h3>Ex-2: Multinomial data</h3>
<p>We return to the taxonomy data used in the lecture on cluster analysis. In the file <code>taxonomy.Rdata</code> you find seven variables measured on plants from four different taxa. We will use multinomial regression as means for classification of taxa. A code file for performing cross-validation of classifications based on multinomial regression is found in the file <code>CV.class.multinom.R</code> on Fronter. Throughout this exercise you may need to increase the number of iterations used in the Maximum Likelihood estimation procedure. The default is 100 iterations. For example, in exercise a. <code>maxit = 200</code> should suffice.</p>
<ol style="list-style-type: lower-alpha">
<li>Use multinomial regression to model the probabilities of the various taxa as a function of the variable <code>Sepal</code>. Save the model as an object called <code>mod1.multi</code>. Use summary to display the results.</li>
</ol>
<div class="ans">
<pre><code># weights:  12 (6 variable)
initial  value 166.355323 
iter  10 value 98.990404
iter  20 value 98.141917
iter  30 value 98.100674
iter  40 value 98.097605
iter  50 value 98.096106
iter  60 value 98.095900
iter  70 value 98.095310
iter  80 value 98.095057
iter  90 value 98.094619
iter 100 value 98.092238
final  value 98.092209 
converged</code></pre>
<pre><code>Call:
multinom(formula = Taxon ~ Sepal, data = taxonomy, maxit = 200)

Coefficients:
    (Intercept)      Sepal
II     1.491219 -0.5931766
III    2.859739 -1.1475571
IV   -48.036300 13.7378995

Std. Errors:
    (Intercept)      Sepal
II     2.313428  0.9143381
III    2.317589  0.9241534
IV    84.933961 24.4393773

Residual Deviance: 196.1844 
AIC: 208.1844 </code></pre>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>What are the estimated linear predictors <span class="math inline">\(\eta_j\)</span> for each of the four taxa, <span class="math inline">\(j=1,2,3,4\)</span>?</li>
</ol>
<div class="ans">
<p>First we extract the estimated regression coefficients. Remember that for the reference level taxon the regression coefficients are assumed equal to zero. We therefore add a row of zeros for this taxon (here <code>taxon = 1</code>).</p>
<pre><code>    (Intercept)      Sepal
I      0.000000  0.0000000
II     1.491219 -0.5931766
III    2.859739 -1.1475571
IV   -48.036300 13.7378995</code></pre>
<p>This gives the following linear predictors:</p>
<p><span class="math display">\[\eta_1 = 0 + 0\cdot \text{Sepal} = 0\]</span></p>
<p><span class="math display">\[\eta_2 = 1.49 - 0.593\cdot \text{Sepal}\]</span></p>
<p><span class="math display">\[\eta_3 = 2.86 - 1.15\cdot \text{Sepal}\]</span></p>
<p><span class="math display">\[\eta_4 = -48.0 + 13.7\cdot \text{Sepal}\]</span></p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>What is the most probable taxon according to this model for a plant with average value of <code>Sepal</code>? (Hint: If your coefficients are stored in a matrix called <code>co</code> you may compute the probabilities for each taxon by using the code <code>probs &lt;- exp(co[,1]+co[,2]*x)/sum(exp(co[,1]+co[,2]*x))</code> where <code>x</code>is the value of interest for <code>Sepal</code>.</li>
</ol>
<div class="ans">
<pre><code>           I           II          III           IV 
0.4334551063 0.3245568634 0.2415048039 0.0004832263 </code></pre>
<pre><code>I 
1 </code></pre>
<p>We see that taxon I is the most probable with a probability equal to 0.433.</p>
<p>Extra: The following figure shows the probabilities of each taxon for various values of <code>Sepal</code>. Remember that these probabilities are the posterior probability estimates for the class in a classification terminology. We classify to the most probable class given the observed predictor values.</p>
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>We observe that taxon III is the most probable for <code>Sepal&lt;2.5</code>, taxon I for <code>2.5 &lt; Sepal &lt; 3.5</code> and taxon IV for <code>Sepal &gt;= 3.5</code>. Taxon 2 is the most probable taxon only for <code>Sepal</code> <span class="math inline">\(\approx\)</span> <code>2.5</code>.</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Execute the following plot command: <code>plot(Sepal ~ Taxon, data=taxonomy)</code>. Use the figure to explain the result from exercise c.</li>
</ol>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<p>We see that taxon I has the median (and probably also the mean) closest to the average Sepal length which is 3.0. Taxa II and III are very similar, but slightly further away, hence their probabilities are a bit smaller. Taxa IV has Sepal lengths much larger than the average and is thus the least probable taxon.</p>
</div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Repeat the taxon classification of exercise c. by means of the <code>predict()</code> - function.</li>
</ol>
<div class="ans">
<pre><code>[1] I
Levels: I II III IV</code></pre>
</div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Use similar plots like in d. to identify other variables which are promising with regard to separating taxa I, II and III (Sepal is already a good variable to distinguish taxon IV from the others). Fit an extended model with the variables you have chosen and save the model as an object called <code>mod2.multi</code>.</li>
</ol>
<div class="ans">
<p>I have found two variables which are promising; <code>Leaf</code> and <code>Petiole</code>, as shown in the figures below.</p>
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-172-1.png" width="672" /><img src="STAT340-2017_files/figure-html/unnamed-chunk-172-2.png" width="672" /></p>
<p><code>Leaf</code> seems to distinguish taxon III from the others, and <code>Petiole</code> may separate taxa I and II.</p>
<p>I therefore fit a model with <code>Sepal</code>, <code>Leaf</code> and <code>Petiole</code> as predictors for taxa. This model requires many iterations in the estimation process. I set <code>maxit = 5000</code> to be sure. (<code>trace =FALSE</code> supresses a long list of convergence details)</p>
<pre><code>Call:
multinom(formula = Taxon ~ Sepal + Leaf + Petiole, data = taxonomy, 
    maxit = 5000, trace = FALSE)

Coefficients:
    (Intercept)     Sepal       Leaf   Petiole
II    554.94697  23.08666  12.755684 -64.61812
III   -67.06407 -73.49301 371.683279 -51.59911
IV    -68.05607  63.33670   6.401691 -14.38513

Std. Errors:
    (Intercept)     Sepal      Leaf  Petiole
II   3631.85085  573.6754  386.6953 464.9205
III  9508.78947 5686.3067 3115.2508 456.4357
IV     21.50562 4053.7436 7258.3741 848.1658

Residual Deviance: 0.0006700854 
AIC: 24.00067 </code></pre>
</div>
<ol start="7" style="list-style-type: lower-alpha">
<li>Use a Chis-square test to test the joint significance of the extra variables you added as you extended <code>mod1.multi</code> to <code>mod2.multi</code>.</li>
</ol>
<div class="ans">
<p>We test whether the difference in deviances between the two models is significant.</p>
<pre><code>&#39;log Lik.&#39; 0.000000000000000000000000000000000000001231206 (df=6)</code></pre>
<p>The p-value indicates that <code>Leaf</code> and <code>Petiole</code> are highly significant in addition to <code>Sepal</code> as predictors in the model.</p>
</div>
<ol start="8" style="list-style-type: lower-alpha">
<li>Use the <code>predict()</code>function on <code>mod2.multi</code> with <code>newdata=taxonomy</code> to classify all plants in the dataset to taxa. Then apply the <code>confusion()</code> function in the <code>mixlm</code>- package to compute the classification performance of the multinomial model. What is the accuracy and apparent classification error?</li>
</ol>
<div class="ans">
<pre><code>         True
Predicted  I II III IV
  I       30  0   0  0
  II       0 30   0  0
  III      0  0  30  0
  IV       0  0   0 30
  Total   30 30  30 30
  Correct 30 30  30 30

Proportions correct
  I  II III  IV 
  1   1   1   1 

N correct/N total = 120/120 = 1</code></pre>
<p>I get an accuracy of 1 and an apparent classification error (APER) of 0. That is, a perfect “fit” to the data. (Note the R-code <code>mixlm::</code> for extracting the confusion function from mixlm without loading the entire package).</p>
</div>
<ol style="list-style-type: lower-roman">
<li>We should watch out for over-fitting. Use the <code>CV.class.multinom()</code> function to run a Leave-One-Out Cross-validation to validate the <code>mod2.multi</code> model.</li>
</ol>
<div class="ans">
<pre><code>         True
Predicted  I II III IV
  I       28  1   1  0
  II       1 29   1  0
  III      1  0  28  0
  IV       0  0   0 30
  Total   30 30  30 30
  Correct 28 29  28 30

Proportions correct
        I        II       III        IV 
0.9333333 0.9666667 0.9333333 1.0000000 

N correct/N total = 115/120 = 0.9583333</code></pre>
<p>The cross-validation gave 5 mis-classifications. Taxon IV is perfectly classified, but there are some mix-up’s between taxa I, II and III. The accuracy is still high (0.96) and the total classification error is correspondingly small (0.04).</p>
</div>

</div>
</div>
<!-- </div> -->
<script>
ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-7-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mixed-effect-model.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["STAT340-2017.pdf", "STAT340-2017.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
