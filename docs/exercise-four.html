<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Methods in Statistics</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="therimalaya/stat340" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Solve Sæbø">


<meta name="date" content="2017-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="analysis-of-variance.html">
<link rel="next" href="exercise-five.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a><ul>
<li class="chapter" data-level="" data-path="reference-books.html"><a href="reference-books.html"><i class="fa fa-check"></i>Reference Books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="create-new-project.html"><a href="create-new-project.html"><i class="fa fa-check"></i>Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-1-data-import.html"><a href="exercise-1-data-import.html"><i class="fa fa-check"></i>Exercise 1: Data Import</a></li>
<li class="chapter" data-level="" data-path="exercise-2-export-data-to-a-file.html"><a href="exercise-2-export-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 2 - Export data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-3-exploring-the-data.html"><a href="exercise-3-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 3 - Exploring the data</a></li>
<li class="chapter" data-level="" data-path="exercise-4-subsets-of-data-and-logical-operators.html"><a href="exercise-4-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 4 - Subsets of data and logical operators</a></li>
<li class="chapter" data-level="" data-path="exercise-5-graphics.html"><a href="exercise-5-graphics.html"><i class="fa fa-check"></i>Exercise 5 - Graphics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exercise-2.html"><a href="exercise-2.html"><i class="fa fa-check"></i>Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i>Analysis of variance</a><ul>
<li class="chapter" data-level="" data-path="exercise-four.html"><a href="exercise-four.html"><i class="fa fa-check"></i>Exercise Four</a></li>
<li class="chapter" data-level="" data-path="exercise-five.html"><a href="exercise-five.html"><i class="fa fa-check"></i>Exercise Five</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis.html"><a href="multivariate-analysis.html"><i class="fa fa-check"></i>Multivariate Analysis</a><ul>
<li class="chapter" data-level="" data-path="exercise-6.html"><a href="exercise-6.html"><i class="fa fa-check"></i>Exercise 6</a></li>
<li class="chapter" data-level="" data-path="exercise-7.html"><a href="exercise-7.html"><i class="fa fa-check"></i>Exercise 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-1.html"><a href="exercise-7-1.html"><i class="fa fa-check"></i>Exercise 7</a></li>
<li class="chapter" data-level="" data-path="exercise-8.html"><a href="exercise-8.html"><i class="fa fa-check"></i>Exercise 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effect-model.html"><a href="mixed-effect-model.html"><i class="fa fa-check"></i>Mixed Effect Model</a><ul>
<li class="chapter" data-level="" data-path="exercise-9.html"><a href="exercise-9.html"><i class="fa fa-check"></i>Exercise 9</a></li>
<li class="chapter" data-level="" data-path="exercise-10.html"><a href="exercise-10.html"><i class="fa fa-check"></i>Exercise 10</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="group-exercises.html"><a href="group-exercises.html"><i class="fa fa-check"></i>Group Exercises</a><ul>
<li class="chapter" data-level="" data-path="exercise-one.html"><a href="exercise-one.html"><i class="fa fa-check"></i>Exercise One</a></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/solve.saebo" target="blank">Solve Sæbø</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Raju Rimal</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercise-four" class="section level2">
<h2>Exercise Four</h2>
<div id="ex-1-chlorine-levels-in-cities" class="section level3">
<h3>Ex-1: Chlorine levels in cities</h3>
<p>Independent measurements of chlorine (ppm parts per million) were taken from 3 large cities:</p>
<pre><code>   City1 City2 City3
1   0.46  1.21  0.44
2   0.92 10.86  0.71
3   0.86  2.09  2.87
4   0.33  6.76  0.81
5   0.53  3.20  7.34
6   5.13  2.02  2.21
7   1.51  2.16  9.00
8   1.00  0.44 17.20
9   0.70  7.80  2.76
10  1.89  1.20  1.07
11  0.68  1.39  2.07
12  0.71  2.42  1.70
13  0.41  1.62  7.89
14  0.78 10.78  0.79
15  0.11  3.25  0.24
16  2.70  0.41  4.44
17  0.41  0.52 15.40
18  0.75  3.71  4.21
19  0.81  5.20  8.63
20  0.35 13.89  3.90</code></pre>
<ul>
<li>Load the city.rdata which is available on Fronter.</li>
</ul>
<p>Before analyzing the data it is best to “stack” the data into two columns, a response column “y” and a city factor column “city”. By using the <code>stack()</code> function in R you can restructure the city data by</p>
<ul>
<li>Use the <code>colnames()</code> function to rename the variables as “y” and “city”.</li>
</ul>
<div class="ans">

</div>
<ul>
<li>Assume an ANOVA-model with chlorine as response and city as a factor. What assumptions do you make?</li>
</ul>
<div class="ans">
<p>The model assumptions are:</p>
<p><span class="math display">\[y_{ij} = \mu_i + \epsilon_{ij}\]</span></p>
<p>where the error terms are assumed independent and identically distributed <span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span>. Further <span class="math inline">\(\mu_i\)</span> is the expected chlorine level in city <span class="math inline">\(i\)</span>.</p>
</div>
<ul>
<li>Make a box-plot of the data. Describe the variabilities between cities and within cities.</li>
</ul>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>City 1 seems to have both the lowest average chlorine levels and the smallest variability in the measurements. Cities 2 and 3 are quite similar with both higher means and variability.</p>
</div>
<ul>
<li>Fit the model and performa a residual analysis. Comment on the model fit.</li>
</ul>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>The residual analysis reveals two problems: 1) Non-constant variability, which was also observed in the boxplot, and 2) A skeewed and non-normal distribution for the residuals with a heavy tail to the right.</p>
</div>
<ul>
<li><p>Make a log-transformation of <span class="math inline">\(y\)</span> to create the variable <code>logy</code>, and add the new variable to your data set by:</p></li>
<li><p>Fit a new model with <code>logy</code> as response and check the model fit again.</p></li>
</ul>
<div class="ans">
<p><img src="STAT340-2017_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>Both problems from the previous model appear to be corrected. We continue with this model.</p>
</div>
<ul>
<li>Estimate all model parameters from the latter model. Explain what the parameters measure given the paramtrization of your choice (See lecture notes from Feb 16th on parametrizations).</li>
</ul>
<div class="ans">
<p>The ANOVA analysis using contr.treatment parametrization:</p>
<pre><code>
Call:
lm(formula = logy ~ city, data = citydata)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.39867 -0.59544 -0.01755  0.71218  1.93257 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.2975     0.2308  -1.289 0.202656    
city(City2)   1.2261     0.3264   3.757 0.000407 ***
city(City3)   1.2690     0.3264   3.888 0.000266 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 1.032 on 57 degrees of freedom
Multiple R-squared: 0.2549,
Adjusted R-squared: 0.2287 
F-statistic: 9.748 on 2 and 57 DF,  p-value: 0.0002283 </code></pre>
<pre><code>Anova Table (Type II tests)

Response: logy
          Sum Sq Df F value    Pr(&gt;F)    
city      20.771  2  9.7484 0.0002283 ***
Residuals 60.724 57                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We observe that <span class="math inline">\(R^2 = 0.25\)</span> indicating that there is still a lot of unexplained variability in the response. We get the following estimates for the city means of log(chlorine)-levels using this parametrization (city 1 is reference city):</p>
<p><span class="math inline">\(\mu_1 = \mu =\)</span> -0.3</p>
<p><span class="math inline">\(\mu_2 = \mu + \alpha_2 =\)</span> 0.93</p>
<p><span class="math inline">\(\mu_3 = \mu + \alpha_3 =\)</span> 0.97</p>
<p>The estimate of the error variance is <span class="math inline">\(\hat{\sigma}^2 = MSE= SSE/(N-3) = 60.724/57 = 1.065\)</span>.</p>
<p>As we see from above, the “intercept” <span class="math inline">\(\mu\)</span> is the expected log-chlorine level for city 1. The <span class="math inline">\(\alpha_2\)</span> is the difference between city 1 and city 2, and <span class="math inline">\(\alpha_3\)</span> is the difference between city 1 and city 3. The <span class="math inline">\(\sigma^2\)</span> is the variance for log-chlorine levels measured in the same city.</p>
</div>
<ul>
<li>State the hypotheses for testing whether the expected chlorine levels differ between the cities, choose a test level <span class="math inline">\(\alpha\)</span> and perform the test. What is the conclusion?</li>
</ul>
<div class="ans">
<p>The hypotheses are:</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 = \mu_3\]</span> versus <span class="math display">\[H_1:\mu_i \neq\mu_{i&#39;}\]</span> for at least two different cities <span class="math inline">\(i\)</span> and <span class="math inline">\(i&#39;\)</span>.</p>
<p>Note:This is by the chosen parametrization equivalent to testing</p>
<p><span class="math display">\[H_0: \alpha_2 = \alpha_3 = 0\]</span> versus <span class="math display">\[H_1:\alpha_i\neq0\]</span> for at least one <span class="math inline">\(i \in \{2,3\}\)</span>.</p>
<p>For test-level <span class="math inline">\(\alpha=0.05\)</span> we reject the null-hypothesis if <span class="math inline">\(F&gt;F_{\alpha, 2, 57}\)</span> or if the p-value is smaller than 0.05. Here we observe a very small p-value and reject the null-hypothesis. We claim that the expected log-chlorine levels differ between at least two of the cities, and from the observed means we know that cities 1 and 3 are significantly different since they have the largest observed difference in means. There may also be a significant difference between cities 1 and 2, and 2 and 3, but this should be checked by a pair-wise contrast.</p>
</div>
</div>
<div id="ex-2-data-from-the-nsr-education-test" class="section level3">
<h3>Ex-2: Data from the NSR education test</h3>
<p>The Norwegian Centre for Science Recruitment (NSR) has an online “education test” where youths may answer a questionnaire to check their so-called cognitive types, their science interest, their preferred learning methods and their interest to various science subjects. The test suggests different ares within the STEM (Science, Technology, Engineering and Mathematics) within which the youth may find suitable work.</p>
<p>We have an excerpt of these data which can be downloaded from Fronter as the <code>nsr.rdata</code> file. The data.frame <code>NSRdata</code> contains two variables, Science and Age:</p>
<pre><code>    Science Age
101     4.2  16
102     4.2  16
103     4.2  16
104     3.0  19
105     2.8  16</code></pre>
<p>“Science” is an average liking score (scale 1-6) to various STEM-subjects, and “Age” is a factor indicating different age-groups:</p>
<ul>
<li>1: 1-12 yrs</li>
<li>13: 13-15 yrs</li>
<li>16: 16-19 yrs</li>
<li>19: 19-29 yrs</li>
<li><p>30: 30 + yrs</p></li>
<li><p>Perform an analysis of the NSR data to check whether Age influences the liking to STEM subjects. State the model, fit the model, check model assumptions, test hypotheses, and give model critique. Write a short summary of the results.</p></li>
</ul>
<div class="ans">
<p>Answer will come later.</p>
</div>

</div>
</div>
<script>
ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="analysis-of-variance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exercise-five.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["STAT340-2017.pdf", "STAT340-2017.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
